<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <style>
    body { margin: 0; display: grid; place-items: center; height: 100vh; }
    canvas { border: 2px solid #000; }
  </style>
</head>
<body>
  <canvas id="c" width="500" height="500"></canvas>

  <script>
    const canvas = document.getElementById("c");
    const ctx = canvas.getContext("2d");

    const dots = [];
    const SPEED = 140;  
    const R = 5;
    const acc = 1/300;

    function randColor() {
      return `hsl(${Math.random() * 360}, 90%, 55%)`;
    }

    canvas.addEventListener("click", (e) => {
      const rect = canvas.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;

      const a = Math.random() * Math.PI * 2;
      dots.push({
        x, y,
        vx: Math.cos(a) * SPEED,
        vy: Math.sin(a) * SPEED,
        color: randColor()
      });
    });

    let last = performance.now();

    function step(now) {
      const dt = (now - last) / 1000;
      last = now;

      for (let i = 0; i < dots.length; i++) {
        let d = dots[i];
        let ax = 0.0, ay = 0.0;

        const w = canvas.width;
        const h = canvas.height;

        const sx = (d.vx > 0) ? 1 : -1;
        const sy = (d.vy > 0) ? 1 : -1;

        const factY = Math.max(0.0, sy * (2.0 * d.y - h));
        const factX = Math.max(0.0, sx * (2.0 * d.x - w));

        const kY = acc * factY * sx;
        ax +=  sy * kY * d.vy;
        ay += -sy * kY * d.vx;

        const kX = acc * factX * sy;
        ax += -sx * kX * d.vy;
        ay +=  sx * kX * d.vx;

        d.vx += ax * dt;
        d.vy += ay * dt;

        const vel = Math.hypot(d.vx, d.vy);
        d.vx = SPEED * d.vx / vel;
        d.vy = SPEED * d.vy / vel;

        d.x += d.vx * dt;
        d.y += d.vy * dt;

        // bounce off walls
        if (d.x - R < 0)               { d.x = R;                 d.vx *= -1; }
        if (d.x + R > canvas.width)    { d.x = canvas.width - R;  d.vx *= -1; }
        if (d.y - R < 0)               { d.y = R;                 d.vy *= -1; }
        if (d.y + R > canvas.height)   { d.y = canvas.height - R; d.vy *= -1; }

        // draw
        ctx.beginPath();
        ctx.arc(d.x, d.y, R, 0, Math.PI * 2);
        ctx.fillStyle = d.color;
        ctx.fill();
      }

      requestAnimationFrame(step);
    }

    requestAnimationFrame(step);

    // Optional: press "c" to clear trails
    window.addEventListener("keydown", (e) => {
      if (e.key.toLowerCase() === "c") ctx.clearRect(0, 0, canvas.width, canvas.height);
    });
  </script>
</body>
</html>
